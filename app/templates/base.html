<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RentalAI v2</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="icon" href="{{ url_for('static', filename='logo.png') }}">
  <style>
    :root { color-scheme: light dark; }
    body {
      background: radial-gradient(circle at 20% 20%, rgba(45,212,191,0.08), transparent 32%),
                  radial-gradient(circle at 80% 0%, rgba(14,116,144,0.12), transparent 28%),
                  linear-gradient(135deg, rgba(15,118,110,0.04), rgba(15,23,42,0.03));
    }
    .card { background: #ffffff; border-radius: 0.75rem; box-shadow: 0 10px 50px rgba(15,23,42,0.08); padding: 1.25rem; border: 1px solid rgba(226,232,240,0.8); }
    .dark .card { background: #0f172a; color: #e5e7eb; border-color: #1e293b; }
    .btn { padding: 0.5rem 0.85rem; border-radius: 0.5rem; background: linear-gradient(135deg,#0f766e,#0ea5a4); color: #ffffff; font-weight: 600; box-shadow: 0 10px 30px rgba(14,165,164,0.35); }
    .btn:hover { background: linear-gradient(135deg,#0ea5a4,#0f766e); }
    .btn-outline { padding: 0.5rem 0.85rem; border-radius: 0.5rem; border: 1px solid #0f766e; color: #0f766e; font-weight: 600; }
    .btn-outline:hover { background: rgba(45,212,191,0.12); }
    .input { width: 100%; border: 1px solid #cbd5e1; border-radius: 0.5rem; padding: 0.6rem; background: #ffffff; transition: box-shadow 150ms ease, border-color 150ms ease; }
    .input:focus { outline: none; border-color: #0f766e; box-shadow: 0 0 0 3px rgba(45,212,191,0.25); }
    .dark .input { background: #111827; color: #ffffff; border-color: #1f2937; }
    .table { min-width: 100%; text-align: left; }
    .th { border-bottom: 1px solid #e2e8f0; padding: 0.75rem; color: #475569; text-transform: uppercase; letter-spacing: 0.01em; font-size: 0.75rem; }
    .dark .th { color: #cbd5e1; border-color: #334155; }
    .td { border-bottom: 1px solid #e2e8f0; padding: 0.75rem; }
    .dark .td { border-color: #334155; }
  </style>
  <script>
    function setChartTheme() {
      const isDark = document.documentElement.classList.contains('dark');
      const text = isDark ? '#e5e7eb' : '#0f172a';
      const grid = isDark ? 'rgba(148,163,184,0.2)' : 'rgba(51,65,85,0.2)';
      if (window.Chart) {
        Chart.defaults.color = text;
        Chart.defaults.borderColor = grid;
        Chart.defaults.plugins.legend.labels.color = text;
        Chart.defaults.scales = Chart.defaults.scales || {};
      }
    }
    function toggleTheme(){
      const html = document.documentElement;
      html.classList.toggle('dark');
      localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');
      setTimeout(() => { location.reload(); }, 50);
    }
    document.addEventListener('DOMContentLoaded', () => {
      const theme = localStorage.getItem('theme') || 'light';
      if(theme === 'dark') document.documentElement.classList.add('dark');
      setChartTheme();
    });
  </script>
</head>
<body class="min-h-screen text-slate-900 dark:text-slate-100">
  <div class="min-h-screen">
    <div class="max-w-7xl mx-auto px-4 lg:px-8 py-6">
      <div class="flex flex-col lg:flex-row rounded-2xl shadow-2xl border border-slate-200/70 dark:border-slate-800 bg-white/80 dark:bg-slate-900/80 backdrop-blur overflow-hidden min-h-[70vh]">
        <aside class="lg:w-72 w-full border-b lg:border-b-0 lg:border-r border-slate-200 dark:border-slate-800 px-6 py-6 bg-gradient-to-b from-white/90 via-white to-teal-50/60 dark:from-slate-900 dark:via-slate-900 dark:to-slate-900/70 space-y-6">
          <div class="flex items-center justify-between lg:justify-start gap-3">
            <div class="flex items-center gap-3">
              <img src="{{ url_for('static', filename='logo.svg') }}" class="w-10 h-10" alt="logo">
              <div>
                <div class="text-xl font-bold text-teal-700">RentalAI</div>
                <div class="text-xs text-slate-500">Property & Lodge Command Center</div>
              </div>
            </div>
            <button class="lg:hidden btn-outline" onclick="toggleTheme()">Theme</button>
          </div>
          <div class="space-y-4">
            <div>
              <div class="text-xs uppercase tracking-[0.2em] text-slate-500 dark:text-slate-400 mb-2">Navigate</div>
              <nav class="space-y-1">
                <a href="{{ url_for('dashboard.home') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Dashboard</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Metrics</span>
                </a>
                <a href="{{ url_for('buildings.list_buildings') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Buildings</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Assets</span>
                </a>
                <a href="{{ url_for('tenants.list_tenants') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Tenants</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">People</span>
                </a>
                <a href="{{ url_for('lodge.list_guests') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Lodge</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Guests</span>
                </a>
                <a href="{{ url_for('summaries.list_summaries') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Summaries</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Reports</span>
                </a>
                <a href="{{ url_for('pdf.axis_to_json') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Axis -> JSON</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Upload</span>
                </a>
                <a href="{{ url_for('pdf.hdfc_ytd') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">HDFC YTD</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Upload</span>
                </a>
                <a href="{{ url_for('auth.change_password') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Change Password</span>
                </a>
                <a href="{{ url_for('auth.logout') }}" class="flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-teal-50 hover:text-teal-700 dark:hover:bg-slate-800">
                  <span class="text-sm font-semibold">Logout</span>
                  <span class="ml-auto text-xs text-slate-400 hidden xl:inline">Sign out</span>
                </a>
              </nav>
            </div>
            <button class="btn w-full hidden lg:block" onclick="toggleTheme()">Toggle Dark/Light</button>
          </div>
        </aside>
        <main class="flex-1 p-6 lg:p-8 bg-gradient-to-b from-white to-transparent dark:from-slate-900 dark:to-transparent">
          <div class="max-w-5xl mx-auto w-full space-y-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                <div class="space-y-2">
                  {% for category, msg in messages %}
                    <div class="p-3 rounded border {{ 'bg-teal-50 text-teal-900 border-teal-100' if category=='success' else 'bg-yellow-50 text-yellow-900 border-yellow-100' if category=='warning' else 'bg-red-50 text-red-900 border-red-100' if category=='danger' else 'bg-slate-50 text-slate-800 border-slate-200 shadow-sm' }}">{{ msg }}</div>
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
          </div>
        </main>
      </div>
    </div>
  </div>
</body>
</html>
